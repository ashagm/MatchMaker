<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Match Maker - Survey</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link href="https://bootswatch.com/darkly/bootstrap.min.css" rel="stylesheet">
    <link href="./css/style.css" rel="stylesheet">
    <script src="https://use.fontawesome.com/c09fe9cceb.js"></script>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"
    integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
    crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMf"></script>
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="./js/questions.js"></script>   
</head>
<body>
    <div class="container">
        <div class = "row ">
            <div class= "col-md-8 col-offset-md-4 well">
                <h2>Survey Questions
                 <a href="/"><button type="button" class="pull-right">
                 <i class="fa fa-home fa-sm" aria-hidden="true"></i></button></a> 
                 </h2>
                <hr>
                <h3><strong>About You</strong></h3>
                <h4>Name (Required)</h4>
                <input type="text" name="" id="name" class="form-control" required="">
                <h4>Link to Photo Image (Required)</h4>
                <input type="text" name="" id="photo" class="form-control" required="">
            </div>    
        </div>    
        <hr>

        <div class = "row">
            <div class= "col-md-8 col-offset-md-4">
                <div id="questions"></div>
                <div>
                    <button type="submit" class="btn btn-primary btn-block" id="submitBtn">
                    <i class="fa fa-check-circle" aria-hidden="true"></i>
                    Submit</button>
                </div>   
            </div>   
        </div>     
        <br>

        <hr>
        <footer class="footer">
          <div class="container">
                <p><a href="/api/friends">API Friends List</a> | <a href="">GitHub Repo</a></p>
          </div>
        </footer>

    </div> 

    <!-- Modal -->
    <div id="resultsModal" class="modal fade" role="dialog">
      <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">Ã—</button>
            <h2 class="modal-title"><strong>Best Match</strong></h2>
          </div>
          <div class="modal-body">
            <h2 id="matchName"></h2>
            <img id="matchImg" src="./FriendFindersurvey_files/10902904.jpg" alt="">
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>

      </div>
    </div>

<script type="text/javascript">
    var choices = ["1 (Strongly Disagree)","2","3","4","5 (Strongly Agree)"];

    var questions = [
        "You enjoy outdoor activities such as hiking and camping.",
        "You consider yourself more of a cat person than a dog person.",
        "Your political views would most closely align with right-wing/conservative.",
        "You enjoy playing or watching sports.",
        "You care a lot about what other people think about you.",
        "You enjoy playing video games.",
        "On the weekends, you like going to the club and dancing.",
        "You enjoy large parties versus more intimate gatherings.",
        "You work well under pressure.",
        "You consider yourself to be an artistic person."
    ];

    for (var i = 0; i < questions.length; i++) {
        var questionDiv = $("<div class= 'well'>");
        questionDiv.attr('id', 'tableWell-' + i+1)
        questionDiv.addClass("form-group");
        
        var questionNumber = $("<h3>");
        questionNumber.text("Question #" + (parseInt(i) + 1));
        
        var questionText = $("<h4>");
        questionText.text(questions[i]);
    
        
        var questionSelect = $("<select class='form-control question'>");
        questionSelect.attr("id", "q" + (parseInt(i) + 1));
        
        for (var j = 0; j < choices.length; j++) {
            var option = $("<option>");
            option.attr("value", (parseInt(j) + 1));
            option.text(choices[j]);
            questionSelect.append(option);
        }

        questionDiv.append(questionNumber).append(questionText).append(questionSelect);
        $("#questions").append(questionDiv);

    }


    $("#submitBtn").on("click", function(event) {
        event.preventDefault();
        var capturedInputValues = [];

        $(".question").each(function() {
            capturedInputValues.push($(this).val());
        });

        var newFriend = {
            name: $("#name").val().trim(),
            photo: $("#photo").val().trim(),
            scores: capturedInputValues
        };

        var currentURL = window.location.origin;

        $.post(currentURL + "/api/friends", newFriend)
        .done(function(data) {

            if (Object.keys(data).length > 1) {
                // MODAL CODE FROM SAMPLE
                $("#matchName").text(data.friend_name);
                $("#matchImg").attr("src", data.friend_image).css("max-height", "400px");

            } else {
                $("#matchName").text(data.error);
            }

            $("#resultsModal").modal('toggle');
            $(".question").each(function() {
                $(this).val("");
            });

        });
    });

</script>


</body>
</html>

